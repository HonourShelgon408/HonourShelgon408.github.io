<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Scheduler</title>

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="manifest" href="/manifest.json">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="/css/materialize.css">
    <link rel="stylesheet" href="/css/materialize.min.css">

    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="firebase-config-details.js"></script>


    <link rel="apple-touch-icon" href="/images/appIcon.png">
    <link rel="icon" href="/images/appIcon.png" />


    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-messaging.js"></script>

    <!-- <script src="./firebase-init.js"></script> -->

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-analytics.js"></script>
    <script>
        
        /*==================
        
        INITIALIZE FIREBASE FIRESTORE
        
        ===================*/
        
        const firebaseConfig = firebase_global;
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
        const db = firebase.firestore();
        
        /*==================
        
        FIREBASE MESSAGING
        
        ===================*/

        const firebaseMessaging = firebase.messaging();
        firebaseMessaging.requestPermission()
        .then(()=>{
            console.log("Have permission.");
            return firebaseMessaging.getToken();
        })
        .then(function(token){
            db.collections('tokens').push({
                token: token,
                noteId: this.data-id ? this.data-id : "null"
            })
            // updateTokensTable();
        })
        .catch(function(error){
            console.log("User didn't grand permission: ", error)
        });

        firebaseMessaging.onMessage(function(payload){
            console.log('onMessage: ', payload)
            console.log(payload.notification.title, payload.notification.body);
        });

        firebaseMessaging.onTokenRefresh(function(){
            firebaseMessaging.getToken()
                .then(function(newToken){
                    console.log("New token: ", newToken);
                })
                .catch(function(error){
                    console.log(error);
                });
        });

    //   console.log(firebase);
    //   console.log(db);

    </script>
</head>

<!-- =====================

    HTML BODY SECTION

========================-->

<body class="grey lighten-4" id="body">

    <!-- top nav -->
    <nav class="z-depth-0 light-blue">
        <!--flattens with no drop shadown -->
        <div class="nav-wrapper container">
            <span class=""><a href="/"><img id="superScheduler" src="/images/ss-192.png" alt="Brand Logo" /></a></span>
            <a href="/"><span>Scheduler</span></a> <!-- just '/' goes to the index directory-->
            <!--title  -->
            <a class="right grey-text text-darken-1">
                <!--positions span to right of nav -->
                <i class="material-icons more-pages sidenav-trigger" data-target="side-menu">menu</i>
                <!-- i tag to display burger icon -->
            </a>

        </div>
    </nav>
    <!-- END-OF top nav -->

    <!-- right-sidenav -->
    <ul id="side-menu" class="sidenav side-menu z-depth-5">
        <li><a class="subheader">Super Scheduler</a></li>
        <li><a href="/error.html" id="sign_in" class="waves-effect">Sign in</a></li>
        <li><a href="/error.html" class="waves-effect">toAdd - About</a></li> <!-- have about the website - then website goals - then feasibility report pdf inserted, maybe a downlaod link? -->
        <li><a href="/error.html" class="waves-effect">toAdd - Settings</a></li>
        <li>
            <div class="divider"></div>
        </li>
        <li><a href="/pages/contact.html" class="waves-effect">
                <i class="material-icons">send</i>Contact Us</a> <!-- envelope icon -->
        </li>
        <li>
            <div class="divider"></div>
        </li>
        <li>
            <div class="center-align col s7 push-s5">Social Media</div>
        </li>
        <li><a href="https://github.com/HonourShelgon408" class="waves-effect">
            <i class="material-icons">
                <img class="web-icon" alt="Github Logo" src="/images/GitHub-Mark.png">
            </i>GitHub</a> 
        </li>
        <li><a href="https://twitter.com/HShelgon" class="waves-effect">
            <i class="material-icons">
                <img class="web-icon" alt="Twitter Logo" src="/images/twitter.png">
            </i>Twitter</a> 
        </li>
    </ul>
    <!-- END-OF right-sidenav -->

    <!-- main content for the page -->
    <div class="notes container grey-text text-darken-1" id="content">
        <div class="noteSect" id="priority"></div>
        <div class="noteSect" id="overview"></div>
        <!-- 
            .grab {cursor: -webkit-grab; cursor: grab;}
            .grabbing {cursor: -webkit-grabbing; cursor: grabbing;} 
            https://www.w3schools.com/cssref/pr_class_cursor.asp
            -->
    </div>
    <!-- END-OF main content for the page -->
    

    <!-- add button for creating new notes -->
    <div class="center">
        <a id="addButton" class="btn-floating btn-small add-btn sidenav-trigger waves-effect waves-light" data-target="side-form">
            <i class="material-icons">add</i>
        </a>
    </div>
    <!-- END-OF add button for creating new notes -->

    <!-- <div class="center">
        <a onclick="darkMode()" id="darkModeButton" class="btn-floating btn-small waves-effect waves-light" >
            Dark Mode
        </a>
    </div> -->

    


    <!-- add note side nav -->
    <div id="side-form" class="sidenav side-form z-depth-5 col s12 l4">
        <form id="addForm" class="add-note container section">
            <!-- ID'S IN THIS FORM REFERENCED IN DB.JS TO GET DATA FROM FORM-->
            <h6>Add a New Note</h6>
            <div class="divider"></div>
            <div class="input-field input-title">
                <input placeholder="Conquer the world" id="noteTitle" type="text" class="validate">
                <label class="active" for="noteTitle">Note Title</label>
            </div>
            
            <!-- old input - new is a textarea              <div class="input-field input-details">
                                                                <input placeholder="...then the world" id="noteBody" type="text" class="validate">
                                                                <label class="active" for="body">Details</label>
                                                            </div> -->

            <div class="input-field input-details">
                <textarea 
                    oninput="auto_grow(this)" 
                    placeholder="But first - a cup of tea" 
                    rows="10" 
                    cols="40" 
                    id="noteBody"
                    type="text" 
                    class="validate materialize-textarea">
                </textarea>
                <label class="active" for="noteBody">Details</label>
            </div>
            <div class="input-field input-wallpaper" hidden=true>
                <input id="wallpaper" type="text" value="white">
                <label for="wallpaper"></label>
            </div>
            <div class="input-field input-rank" hidden=true>
                <input id="rank" type="text" value="parent">
                <label for="rank"></label>
            </div>

            <div class="input-field col s6">
                <button class="btn-small">Create Note</button>
            </div>
            
        </form>
    </div>
    <!-- END-OF add note side nav -->

    <!-- update note side nav -->
    <div id="update-form" class="sidenav side-form z-depth-5 col s12 l4">
        <form id="updateForm" class="update-note container section">
            <!-- ID'S IN THIS FORM REFERENCED IN DB.JS TO GET DATA FROM FORM-->
            <h6>Update Note</h6>
            <div class="divider"></div>
            <div class="input-field input-id">
                <input id="updateNoteId" type="text" class="validate">
                <label class="active" for="updateNoteId">note id</label>
            </div>
            <div class="input-field input-title">
                <input placeholder="...Title..." id="updateNoteTitle" type="text" class="validate">
                <label class="active" for="updateNoteTitle">Note Title</label>
            </div>
            <div class="input-field input-details">
                <textarea 
                    oninput="auto_grow(this)" 
                    placeholder="...body..."
                    rows="10"
                    cols="40"
                    id="updateNoteBody"
                    type="text"
                    class="validate materialize-textarea">
                </textarea>
                <label class="active" for="updateNoteBody">Details</label>
            </div>
            <div class="input-field input-wallpaper" hidden=true>
                <input id="updateWallpaper" type="text" value="white">
                <label for="updateWallpaper"></label>
            </div>
            <div class="input-field input-rank" hidden=true>
                <input id="updateRank" type="text" value="parent">
                <label for="updateRank"></label>
            </div>

            <div class="input-field col s6">
                <button class="btn-small">Update Note</button>
            </div>
            
        </form>
    </div>
    <!-- END-OF update note side nav -->

    <div class="col s4 notificationBox" hidden=true>
        <p id="notificationTitle" class="notificationBoxfield"></p>
        <p id="notificationBody" class="notificationBoxfield"></p>
    </div>

    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script defer src="js/swReg.js"></script> <!-- registers and handles service worker through sw.js -->
    <script defer src="js/main.js"></script> <!-- javascript for the page -->
    <script defer src="js/db.js"></script> <!-- database for the page -->


</body>

</html>